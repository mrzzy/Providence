#
# Providence
# Transforms
# Staging Models Config
# DBT Staging: UOB Models
#

version: 2

models:
  - name: stg_uob_account
    description: A UOB Bank account.
    columns:
      - name: account_no
        description: UOB Bank account number.
        tests:
          - not_null
      - name: name
        description: Product name of the UOB Bank Account.
        tests:
          - not_null
      - name: currency_code
        destination: "3 character ISO code of the currency used by Bank Account."
        tests:
          - not_null
      - name: statement_begin
        destination: >-
          Timestamp denoting the start the date range of the bank statement form
          the Bank Account information was derived.
        tests:
          - not_null
      - name: statement_end
        destination: >-
          Timestamp denoting the end (inclusive) the date range of the bank statement
          from which the Bank Account information was derived.
        tests:
          - not_null
    tests:
      - dbt_utils.expression_is_true:
          expression: "statement_begin <= statement_end"
